<template name="task">
	<div class="lea-task-container mb-5">
		{{#unless loadComplete}}
			<div class="w-100 text-center">
				<i class="fa fas fa-3x fa-fw fa-spinner fa-pulse"></i>
			</div>
		{{else}}
			{{#with sessionDoc}}
				{{#container}}
					{{> navbar sessionDoc=..}}
				{{/container}}
			{{/with}}

			{{#with taskDoc}}
				{{#container class="lea-task-content-container"}}
					{{#with ../story}}
						<div class="card my-2">
							{{#each storyElement in this}}
								<div class="card-body">
									{{> TaskRendererFactory content=storyElement type=currentType}}
								</div>
							{{/each}}
						</div>
					{{/with}}

					{{#with ../stimuli}}
						<div class="card my-2">
							{{#each stimuli in this}}
								<div class="card-body">
									{{> TaskRendererFactory content=stimuli type=currentType}}
								</div>
							{{/each}}
						</div>
					{{/with}}

					{{#with ../instructions}}
						<div class="card my-2">
							<div class="card-body d-flex align-items-center">
							<span class="w-100">
								{{#each instruction in this}}
									{{> TaskRendererFactory content=instruction type=currentType}}
								{{/each}}
							</span>
								<span class="text-light">
								<i class="fa fas fa-fw fa-3x fa-info"></i>
							</span>
							</div>
						</div>
					{{/with}}

					{{#with dimension}}
						<div class="card my-4 border border-secondary">
							{{#with currentPage}}
								{{#each taskContent in this}}
									<div class="card-body">
										<div class="w-100 h-100 lea-task-current-content">
											{{> TaskRendererFactory content=taskContent type=currentType}}
										</div>
									</div>
								{{/each}}
								<div class="card-body d-flex justify-content-between align-items-center">
									{{#if hasPrev}}
										{{> actionButton type=currentType outline=true tts="common.back" btnClass="lea-pagenav-button"
												data-action="back" type=currentType
												label=(i18n "common.forward") class="ml-auto"}}
									{{/if}}
									<span class="text-{{currentType}}">{{currentPageCount}} / {{maxPages}}</span>
									{{#if hasNext}}
										<button class="btn  btn-outline-{{currentType}} lea-pagenav-button ml-auto"
												data-action="next">
											<i class="fa fas fa-fw fa-arrow-right"></i>
										</button>
									{{/if}}
								</div>
							{{/with}}
						</div>

						{{#unless hasNext}}
							<div class="card-body d-flex justify-content-center">
								{{> actionButton type=currentType tts="common.finish" btnClass="lea-pagenav-finish-button"
										type=currentType class="lea-task-finish-group"
										icon="arrow-right" iconPos="right" label=(i18n "common.finish") }}
							</div>
						{{/unless}}
					{{/with}}
				{{/container}}
			{{/with}}
		{{/unless}}
	</div>
</template>