<template name="complete">
    <div class="lea-complete-container" id="lea-complete-print-root">

        {{#onComplete complete=loadComplete}}
            {{#container class="lea-unit-nav-container"}}
                {{> navbar navbarData}}
            {{/container}}
        {{/onComplete}}

        {{#if showThanks}}
            {{#container class="d-print-none"}}
                <div class="card my-4">
                    <div class="card-body">
                        {{#onComplete complete=loadComplete}}
                            {{> textGroup tts="pages.complete.thankYou"
                                    label=(i18n "pages.complete.thankYou")
                                    type=currentType}}
                        {{/onComplete}}
                    </div>
                </div>
            {{/container}}
        {{/if}}

        {{!-- we display a failed state container to indicate to get feedback at a later point --}}
        {{#if failed}}
            {{#container}}
                <div class="card my-4">
                    <div class="card-body">
                        {{#onComplete complete=loadComplete}}
                            {{> textGroup tts="pages.complete.failed"
                                    label=(i18n "pages.complete.failed")
                                    type=currentType}}
                        {{/onComplete}}

                    </div>
                </div>

                <div class="card-body">
                    {{#onComplete complete=loadComplete}}
                        {{> actionButton tts="common.toOverview"
                                label=(i18n "common.toOverview")
                                type=currentType
                                block=true
                                btnClass="lea-to-overview-button"}}
                    {{/onComplete}}
                </div>
            {{/container}}
        {{/if}}

        {{#if showResults}}
            {{#container}}

            {{!-- iterate all possible feedback levels --}}
                {{#with feedbackLevels}}
                    {{#each feedbackLevel in this}}

                    {{! only display category if there are any competencies related }}
                        {{#with (getCompetencies @index)}}
                            <ul class="card list-group my-4">
                                <li class="list-group-item font-weight-bold d-flex">
                                    {{> textGroup text=feedbackLevel.description
                                            label=feedbackLevel.description
                                            groupClass="w-100"
                                            type=currentType}}
                                    {{> icon fw=true far=true name=feedbackLevel.icon scale=2}}
                                </li>


                                {{!-- display all related competencies for this feedback --}}

                                {{#each competencyId in this}}
                                    <li class="list-group-item">
                                        {{#let competency=(getCompetency competencyId)}}
                                            {{> textGroup text=competency.description
                                                    label=competency.description
                                                    groupClass="w-100"
                                                    type=currentType}}
                                            {{#if competency.example}}
                                                {{> textGroup text=competency.example
                                                        label=competency.example
                                                        groupClass="w-100"
                                                        type=currentType}}
                                            {{/if}}
                                        {{/let}}
                                    </li>
                                {{/each}}
                            </ul>
                        {{/with}}
                    {{/each}}
                {{else}}
                    <div class="card my-4">
                        <div class="card-body">
                            <h1 class="text-center">
                                <i class="fa fas fa-fw fa-spinner fa-pulse"></i>
                            </h1>
                        </div>
                    </div>
                {{/with}}
            {{/container}}

            {{#container class="d-print-none"}}
                <div class="card lea-complete-showprint-container ">
                    <div class="card-body font-weight-bold">
                        {{> textGroup tts="pages.complete.youCanPrint" type=currentType}}
                    </div>
                    <div class="card-body">
                        {{#textGroup tts="pages.complete.printResults"
                                     groupClass="w-100"
                                     label=(i18n "pages.complete.printResults")
                                     type=currentType}}
                            <button class="ml-auto btn btn-lg btn-outline-{{currentType}} print-simple">
                                <i class="fa fas fa-fw fa-print"></i>
                            </button>
                        {{/textGroup}}
                    </div>
                    <div class="card-body">
                        {{#textGroup tts="pages.complete.printResultsTeacher"
                                     groupClass="w-100"
                                     label=(i18n "pages.complete.printResultsTeacher")
                                     type=currentType}}
                            <button class="ml-auto btn btn-outline-light" disabled>
                                <i class="fa fas fa-fw fa-print"></i>
                            </button>
                        {{/textGroup}}
                    </div>
                </div>

                <div class="card-body">
                    {{> actionButton tts="common.forward" label=(i18n "common.forward") block=true btnClass="lea-showresults-forward-button" class="ml-auto" type=currentType}}
                </div>
            {{/container}}
        {{/if}}

        {{#if showDecision}}
            {{#container}}
                <div class="card lea-complete-showprint-container">
                    <div class="card-body">
                        {{#with currentType}}
                            {{> textGroup tts="pages.complete.continueOrEnd" type=this }}
                        {{/with}}
                    </div>
                </div>

                <div class="card-body d-flex justify-content-between">
                    {{> actionButton tts="common.back" label=(i18n "common.back") type=currentType
                            btnClass="lea-showdecision-back-button" outline=true}}
                    {{> actionButton tts="common.end" label=(i18n "common.end") type=currentType
                            btnClass="lea-end-button" outline=true}}
                    {{> actionButton tts="actions.continue" label=(i18n "actions.continue") type=currentType
                            btnClass="lea-continue-button"}}
                </div>
            {{/container}}
        {{/if}}
    </div>
</template>